<!doctype html>

<html lang="en" class="light-style layout-navbar-fixed layout-menu-fixed layout-compact" dir="ltr" data-theme="theme-default" data-assets-path="/assets/" data-template="vertical-menu-template" data-style="light">
  <head>
    <%- include('../../layout/head') %>
    <link rel="stylesheet" href="/assets/vendor/css/pages/app-invoice.css" />
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->

       <%- include('../../layout/aside') %>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

         <%- include('../../layout/side') %>

          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->

            <div class="container-xxl flex-grow-1 container-p-y">
              <div class="row invoice-preview">
                <!-- Invoice -->
                <div class="col-xl-9 col-md-8 col-12 mb-md-0 mb-0" id="invoice">
                  <div class="card invoice-preview-card p-sm-12 p-6">
                    <div class="card-body invoice-preview-header rounded">
                      <div class="d-flex justify-content-between flex-xl-row flex-md-column flex-sm-row flex-column">
                        <div class="mb-xl-0 mb-0 text-heading">
                          <div class="d-flex svg-illustration mb-3 gap-2 align-items-center">
                            <div class="align-items-center" style="text-align: center;">
                              <img src="/logo.png" alt="" style="text-align: center;">
                            </div>

                            <!-- <span class="app-brand-text fw-bold fs-4 ms-50"> Vuexy </span> -->
                          </div>
                          <p class="mb-1" style="font-size: 29PX; font-weight: 900;">ABAJI AREA COUNCIL</p>
                          <p class="mb-1"><strong>FEDERAL CAPITAL ADMINISTRATION</strong></p>
                          <p class="mb-1">_______________________________DEPARTMENT</p>
                        </div>
                        <div>
                          <h5 class="mb-1">Telex <%= revenue.assessment_no %></h5>
                          <div class="mb-1 text-heading">
                            <span>Date Issues:</span>
                            <span>April 25, 2021</span>
                          </div>
                          <div class="text-heading">
                            <span>Date Due:</span>
                            <span>April 25, 2021</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="card-body px-0">
                      <div class="row">
                        <div class="col-xl-12 col-md-12 col-sm-12 col-12 mb-xl-0 mb-md-12 mb-sm-0 mb-2">
                          <!-- <h6>Invoice To:</h6> -->
                          <p class="mb-0">Our ref:&nbsp;&nbsp; <strong>2147483647</strong></p>
                          <p class="mb-0">Your Ref:&nbsp;&nbsp;<strong><%= revenue.bill_ref_no %></strong> </p>
                          <p class="mb-0">Name: &nbsp;&nbsp;<strong><%= revenue.name_of_business %></strong></p>
                        </div>
                        
                      </div>
                    </div>
                    <div class="card-body px-0">
                      <h4 style="text-align: center;"><u><strong>NOTICE OF PAYMENT OF OPERATION PERMIT</strong></u></h4>
                      <p>The Honourable Chairman Abaji Area Council has directed that you should be notify on the payment of operation permit in accordance with Federal Capital Territory (Applicable Law) Decree 12 of 1984 as amended by Local Govemment Basic Constitution and Transitional Provision Decrec 1991.</p>
                      <ul>
                        <li>Business Location: &nbsp;&nbsp;<strong><%= revenue.address_of_property %></strong></li>
                        <li>Type of Business: &nbsp;&nbsp;<strong><%= revenue.type_of_property %></strong></li>
                        <% let j = parseInt(revenue.rate_year) +1 %>
                        <li>Period: &nbsp;&nbsp;<strong><%= revenue.rate_year+"/"+j  %></strong></li>
                        <li>The total amount due is â‚¦<strong><%= parseFloat(revenue.grand_total).toFixed(2).toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") %></strong></li>
                      </ul>
                      <p>
                        Payable not later than two weeks from the date of this notice to Revenue Account 2000318051 with First Bank of Nigeria PLC Abaji Branch or Certified Bank Draft or come to Revenue Office Abaji Area Council for more clarification.
                      </p>
                      <p>
                        Failure which the Hon. Chairman of the Area Council may direct the enforcement (Legal Unit of the Area Council to take necessary action. Against you)
                      </p>
                      <p>
                        Please, note that Bank Teller in respect of payment made into the Bank Account should be returned to the Revenue Section Abaji Area Council for issuance of receipt.
                      </p>
                      <p>
                        You should also know that any payment made to location other than the one prescribed above should be treated as invalid.
                      </p>
                      <p>
                        Your prompt response will be apprecited. Thanking you in anticipation please.
                      </p>
                    </div>
                    
                    <div class="table-responsive">
                      <table class="table m-0 table-borderless">
                        <tbody>
                          <tr>
                            
                            <td class="px-0 py-6 w-px-100" colspan="2" style="width: 70%;">
                             
                           
                            </td>
                            <td class="align-top pe-6 ps-0 py-6">
                              <p class="mb-1" style="text-align: end;">
                                <span class="me-2 h6">DH REVENUE</span> <br>
                                <span>FOR: COUNCIL TREASURER</span> <br>
                                <span>ABAJI AREA COUNCIL</span>
                              </p>
                              <!-- <span>Thanks for your business</span> -->
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <!-- <hr class="mt-0 mb-6" />
                    <div class="card-body p-0">
                      <div class="row">
                        <div class="col-12">
                          <span class="fw-medium text-heading">Note:</span>
                          <span
                            >It was a pleasure working with you and your team. We hope you will keep us in mind for
                            future freelance projects. Thank You!</span
                          >
                        </div>
                      </div>
                    </div> -->
                  </div>
                </div>
                <!-- /Invoice -->

                <!-- Invoice Actions -->
                <div class="col-xl-3 col-md-4 col-12 invoice-actions">
                  <div class="card">
                    <div class="card-body">
                      <button
                        class="btn btn-primary d-grid w-100 mb-4"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#sendInvoiceOffcanvas">
                        <span class="d-flex align-items-center justify-content-center text-nowrap"
                          ><i class="ti ti-send ti-xs me-2"></i>Send Invoice</span
                        >
                      </button>
                      <button class="btn btn-label-secondary d-grid w-100 mb-4">Download</button>
                      <div class="d-flex mb-4">
                        <a
                          class="btn btn-label-secondary d-grid w-100 me-4"
                          href="javascript:;" onclick="printDiv('invoice')">
                          Print
                        </a>
                        <a href="./app-invoice-edit.html" class="btn btn-label-secondary d-grid w-100"> Edit </a>
                      </div>
                      <button
                        class="btn btn-success d-grid w-100"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#addPaymentOffcanvas">
                        <span class="d-flex align-items-center justify-content-center text-nowrap"
                          >Make Payment</span
                        >
                      </button>
                    </div>
                  </div>
                </div>
                <!-- /Invoice Actions -->
              </div>

              <!-- Offcanvas -->
              <!-- Send Invoice Sidebar -->
              <div class="offcanvas offcanvas-end" id="sendInvoiceOffcanvas" aria-hidden="true">
                <div class="offcanvas-header mb-6 border-bottom">
                  <h5 class="offcanvas-title">Send Invoice</h5>
                  <button
                    type="button"
                    class="btn-close text-reset"
                    data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
                </div>
                <div class="offcanvas-body pt-0 flex-grow-1">
                  <form>
                    <div class="mb-6">
                      <label for="invoice-from" class="form-label">From</label>
                      <input
                        type="text"
                        class="form-control"
                        id="invoice-from"
                        value="shelbyComapny@email.com"
                        placeholder="company@email.com" />
                    </div>
                    <div class="mb-6">
                      <label for="invoice-to" class="form-label">To</label>
                      <input
                        type="text"
                        class="form-control"
                        id="invoice-to"
                        value="qConsolidated@email.com"
                        placeholder="company@email.com" />
                    </div>
                    <div class="mb-6">
                      <label for="invoice-subject" class="form-label">Subject</label>
                      <input
                        type="text"
                        class="form-control"
                        id="invoice-subject"
                        value="Invoice of purchased Admin Templates"
                        placeholder="Invoice regarding goods" />
                    </div>
                    <div class="mb-6">
                      <label for="invoice-message" class="form-label">Message</label>
                      <textarea class="form-control" name="invoice-message" id="invoice-message" cols="3" rows="8">
Dear Queen Consolidated,
          Thank you for your business, always a pleasure to work with you!
          We have generated a new invoice in the amount of $95.59
          We would appreciate payment of this invoice by 05/11/2021</textarea
                      >
                    </div>
                    <div class="mb-6">
                      <span class="badge bg-label-primary">
                        <i class="ti ti-link ti-xs"></i>
                        <span class="align-middle">Invoice Attached</span>
                      </span>
                    </div>
                    <div class="mb-6 d-flex flex-wrap">
                      <button type="button" class="btn btn-primary me-4" data-bs-dismiss="offcanvas">Send</button>
                      <button type="button" class="btn btn-label-secondary" data-bs-dismiss="offcanvas">Cancel</button>
                    </div>
                  </form>
                </div>
              </div>
              <!-- /Send Invoice Sidebar -->

              <!-- Add Payment Sidebar -->
              <div class="offcanvas offcanvas-end" id="addPaymentOffcanvas" aria-hidden="true">
                <div class="offcanvas-header border-bottom">
                  <h5 class="offcanvas-title">Add Payment</h5>
                  <button
                    type="button"
                    class="btn-close text-reset"
                    data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
                </div>
                <div class="offcanvas-body flex-grow-1">
                  <div class="d-flex justify-content-between bg-lighter p-2 mb-4">
                    <p class="mb-0">Wallet Balance:</p>
                    <p class="fw-medium mb-0" id="wal"></p>
                  </div>
                  <form id="make_payment">
                    <div class="mb-6">
                      <label class="form-label" for="invoiceAmount">Payment Amount</label>
                      <div class="input-group">
                        <span class="input-group-text">â‚¦</span>
                        <input
                          type="text"
                          id="invoiceAmount"
                          value="<%= parseFloat(revenue.grand_total).toFixed(2).toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") %>"
                          name="invoiceAmount"
                          class="form-control invoice-amount"
                          placeholder="100" />
                      </div>
                    </div>
                    <div class="mb-6">
                      <label class="form-label" for="payment-date">Payment Date</label>
                      <input id="payment-date" class="form-control invoice-date" type="date" />
                    </div>
                    <div class="mb-6">
                      <label class="form-label" for="payment-method">Payment Method</label>
                      <select class="form-select" id="payment-method">
                        <option value="" selected disabled>Select payment method</option>
                        <option value="Wallet" selected>Wallet</option>
                        <!-- <option value="Bank Transfer">Bank Transfer</option>
                        <option value="Debit Card">Debit Card</option>
                        <option value="Credit Card">Credit Card</option>
                        <option value="Paypal">Paypal</option> -->
                      </select>
                    </div>
                    <div class="mb-6">
                      <label class="form-label" for="payment-note">Internal Payment Note</label>
                      <textarea class="form-control" id="payment-note" rows="2"></textarea>
                    </div>
                    <div class="mb-6 d-flex flex-wrap">
                      <button type="button" class="btn btn-primary me-4" id="wallet_payment" data-bs-dismiss="offcanvas">Send</button>
                      <button type="button" class="btn btn-label-secondary"  data-bs-dismiss="offcanvas">Cancel</button>
                    </div>
                  </form>
                </div>
              </div>
              <!-- /Add Payment Sidebar -->
              </div>
              <!-- / Content -->

        <%- include('../../layout/footer') %>
        <script src="/assets/js/offcanvas-send-invoice.js"></script>
         <!-- Page JS -->
    <!-- <script src="/assets/js/tables-datatables-basic.js"></script> -->
    <script>
       function printDiv(invoice) {
            var printContents = document.getElementById("invoice").innerHTML;
            var originalContents = document.body.innerHTML;

            document.body.innerHTML = printContents;

            window.print();

            document.body.innerHTML = originalContents;
      }

      addEventListener("DOMContentLoaded", async (event) => {
        const wal = document.getElementById("wal")
        const request = await fetch('/admin/wallet_balance')
        const balance = await request.json();
        wal.textContent = balance.status == true ? parseFloat(balance.balance).toFixed(2).toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : "0.00";

        // console.log(parseFloat(balance.balance) > parseFloat('<%= revenue.grand_total %>'))
        if(parseFloat(balance.balance) < parseFloat('<%= revenue.grand_total %>')) {
          document.getElementById("wallet_payment").disabled = true;
        }
      });

      if(document.getElementById("make_payment")) {
        const make_payment = document.getElementById("make_payment");
        make_payment.addEventListener("submit", async function(e) {
          e.preventDefault();
        }) 
      }



    </script>
  </body>
</html>
